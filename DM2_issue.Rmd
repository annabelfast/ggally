---
title: "DM2_issue"
output: html_document
---

## Load packages

```{r}
library(effects)
library(ggplot2)
library(GGally)
library(patchwork)
```

## The Plot 

```{r}
# Load the data
data(Arrests)

# Create individual plots for continuous variables
plot_continuous <- function(data, x_var) {
  ggplot(data, aes_string(x = x_var)) +
    geom_histogram(aes(fill = released), bins = 20, position = "dodge") +
    labs(title = paste(x_var, "vs Released"),
         x = x_var,
         y = "Count") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

# Create plots for categorical variables
plot_categorical <- function(data, x_var) {
  ggplot(data, aes_string(x = x_var, fill = "released")) +
    geom_bar(position = "dodge") +
    labs(title = paste(x_var, "vs Released"),
         x = x_var,
         y = "Count") +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

# Identify continuous and categorical variables
continuous_vars <- sapply(Arrests, is.numeric)
categorical_vars <- sapply(Arrests, is.factor)

# Exclude 'released' from continuous variables
continuous_vars <- continuous_vars & (names(Arrests) != "released")

# Create plots
cont_plots <- lapply(names(Arrests)[continuous_vars], function(var) plot_continuous(Arrests, var))
cat_plots <- lapply(names(Arrests)[categorical_vars], function(var) plot_categorical(Arrests, var))

# Combine plots using patchwork
final_plot <- Reduce(`+`, c(cont_plots, cat_plots)) + 
  plot_layout(ncol = 3, guides = "collect")

# Display the plot
print(final_plot)
```
